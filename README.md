Esse código recebe um arquuivo pdb, copia as linhas começadas em HETATM e ATOM, separa por cadeias (o 21 caractere nessa linha informa a qual cadeia o atomo ertence) e ttambem isola o ligante e outrasmoléculas não proteica, que são definidas com  HETATM no começo das linhas. Como saída temos arquivos separados, nomeados nome_do _arquivo_original+cadeia . Ja o arquivo conteendo o ligante e possiveis cofatores  é nomeado nome_do_arquivo_original+ligante.pdb.
